var app=function(){"use strict";var e=!1,t=Array.isArray,n=Array.prototype.indexOf,o=Array.from,l=Object.defineProperty,i=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyDescriptors,a=Object.prototype,s=Array.prototype,u=Object.getPrototypeOf,c=Object.isExtensible;const d=()=>{};function f(e){return e()}function v(e){for(var t=0;t<e.length;t++)e[t]()}const p=32,m=64,g=256,h=512,y=1024,w=2048,b=4096,z=8192,S=16384,x=65536,M=1<<20,k=1<<21,D=Symbol("$state"),_=Symbol("legacy props");function $(e){return e===this.v}function E(e,t){return e!=e?t==t:e!==t||null!==e&&"object"==typeof e||"function"==typeof e}function C(e){return!E(e,this.v)}let L=!1;const T=Symbol();function R(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let q=null;function j(e){q=e}function O(e,t=!1,n){var o=q={p:q,c:null,d:!1,e:null,m:!1,s:e,x:null,l:null};L&&!t&&(q.l={s:null,u:null,r1:[],r2:V(!1)}),de((()=>{o.d=!0}))}function N(e){const t=q;if(null!==t){const e=t.e;if(null!==e){var n=Ue,o=Pe;t.e=null;try{for(var l=0;l<e.length;l++){var i=e[l];Be(i.effect),We(i.reaction),ve(i.fn)}}finally{Be(n),We(o)}}q=t.p,t.m=!0}return{}}function A(){return!L||null!==q&&null===q.l}function P(e){if("object"!=typeof e||null===e||D in e)return e;const n=u(e);if(n!==a&&n!==s)return e;var o=new Map,l=t(e),r=Z(0),c=Pe,d=e=>{var t=Pe;We(c);var n=e();return We(t),n};return l&&o.set("length",Z(e.length)),new Proxy(e,{defineProperty(e,t,n){"value"in n&&!1!==n.configurable&&!1!==n.enumerable&&!1!==n.writable||function(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}();var l=o.get(t);return void 0===l?(l=d((()=>Z(n.value))),o.set(t,l)):Y(l,d((()=>P(n.value)))),!0},deleteProperty(e,t){var n=o.get(t);if(void 0===n)t in e&&(o.set(t,d((()=>Z(T)))),I(r));else{if(l&&"string"==typeof t){var i=o.get("length"),a=Number(t);Number.isInteger(a)&&a<i.v&&Y(i,a)}Y(n,T),I(r)}return!0},get(t,n,l){if(n===D)return e;var r=o.get(n),a=n in t;if(void 0!==r||a&&!i(t,n)?.writable||(r=d((()=>Z(P(a?t[n]:T)))),o.set(n,r)),void 0!==r){var s=ct(r);return s===T?void 0:s}return Reflect.get(t,n,l)},getOwnPropertyDescriptor(e,t){var n=Reflect.getOwnPropertyDescriptor(e,t);if(n&&"value"in n){var l=o.get(t);l&&(n.value=ct(l))}else if(void 0===n){var i=o.get(t),r=i?.v;if(void 0!==i&&r!==T)return{enumerable:!0,configurable:!0,value:r,writable:!0}}return n},has(e,t){if(t===D)return!0;var n=o.get(t),l=void 0!==n&&n.v!==T||Reflect.has(e,t);if((void 0!==n||null!==Ue&&(!l||i(e,t)?.writable))&&(void 0===n&&(n=d((()=>Z(l?P(e[t]):T))),o.set(t,n)),ct(n)===T))return!1;return l},set(e,t,n,a){var s=o.get(t),u=t in e;if(l&&"length"===t)for(var c=n;c<s.v;c+=1){var f=o.get(c+"");void 0!==f?Y(f,T):c in e&&(f=d((()=>Z(T))),o.set(c+"",f))}void 0===s?u&&!i(e,t)?.writable||(Y(s=d((()=>Z(void 0))),d((()=>P(n)))),o.set(t,s)):(u=s.v!==T,Y(s,d((()=>P(n)))));var v=Reflect.getOwnPropertyDescriptor(e,t);if(v?.set&&v.set.call(a,n),!u){if(l&&"string"==typeof t){var p=o.get("length"),m=Number(t);Number.isInteger(m)&&m>=p.v&&Y(p,m+1)}I(r)}return!0},ownKeys(e){ct(r);var t=Reflect.ownKeys(e).filter((e=>{var t=o.get(e);return void 0===t||t.v!==T}));for(var[n,l]of o)l.v===T||n in e||t.push(n);return t},setPrototypeOf(){!function(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}()}})}function I(e,t=1){Y(e,e.v+t)}function W(e){var t=2050,n=null!==Pe&&2&Pe.f?Pe:null;null===Ue||null!==n&&0!==(n.f&g)?t|=g:Ue.f|=M;return{ctx:q,deps:null,effects:null,equals:$,f:t,fn:e,reactions:null,rv:0,v:null,wv:0,parent:n??Ue}}function U(e){const t=W(e);return t.equals=C,t}function B(e){var t=e.effects;if(null!==t){e.effects=null;for(var n=0;n<t.length;n+=1)Se(t[n])}}function F(e){var t,n=Ue;Be(function(e){for(var t=e.parent;null!==t;){if(!(2&t.f))return t;t=t.parent}return null}(e));try{B(e),t=tt(e)}finally{Be(n)}return t}function H(e){var t=F(e);(e.equals(t)||(e.v=t,e.wv=Ke()),Oe)||vt(e,!Ge&&0===(e.f&g)||null===e.deps?y:b)}const J=new Map;function V(e,t){return{f:0,v:e,reactions:null,equals:$,rv:0,wv:0}}function Z(e,t){const n=V(e);return He(n),n}function X(e,t=!1){const n=V(e);return t||(n.equals=C),L&&null!==q&&null!==q.l&&(q.l.s??=[]).push(n),n}function Y(e,t,n=!1){return null!==Pe&&!Ie&&A()&&18&Pe.f&&!Fe?.includes(e)&&function(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}(),G(e,n?P(t):t)}function G(e,t){if(!e.equals(t)){var n=e.v;Oe?J.set(e,t):J.set(e,n),e.v=t,2&e.f&&(0!==(e.f&w)&&F(e),vt(e,0===(e.f&g)?y:b)),e.wv=Ke(),K(e,w),!A()||null===Ue||0===(Ue.f&y)||96&Ue.f||(null===Ze?function(e){Ze=e}([e]):Ze.push(e))}return t}function K(e,t){var n=e.reactions;if(null!==n)for(var o=A(),l=n.length,i=0;i<l;i++){var r=n[i],a=r.f;0===(a&w)&&((o||r!==Ue)&&(vt(r,t),1280&a&&(2&a?K(r,b):st(r))))}}var Q,ee,te,ne;function oe(e=""){return document.createTextNode(e)}function le(e){return te.call(e)}function ie(e){return ne.call(e)}function re(e,t){return le(e)}function ae(e,t){var n=le(e);return n instanceof Comment&&""===n.data?ie(n):n}function se(e,t=1,n=!1){let o=e;for(;t--;)o=ie(o);return o}function ue(e){null===Ue&&null===Pe&&function(){throw new Error("https://svelte.dev/e/effect_orphan")}(),null!==Pe&&0!==(Pe.f&g)&&null===Ue&&function(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}(),Oe&&function(){throw new Error("https://svelte.dev/e/effect_in_teardown")}()}function ce(e,t,n,o=!0){var l=Ue,i={ctx:q,deps:null,nodes_start:null,nodes_end:null,f:e|w,first:null,fn:t,last:null,next:null,parent:l,prev:null,teardown:null,transitions:null,wv:0};if(n)try{lt(i),i.f|=32768}catch(e){throw Se(i),e}else null!==t&&st(i);if(!(n&&null===i.deps&&null===i.first&&null===i.nodes_start&&null===i.teardown&&!(1048704&i.f))&&o&&(null!==l&&function(e,t){var n=t.last;null===n?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}(i,l),null!==Pe&&2&Pe.f)){var r=Pe;(r.effects??=[]).push(i)}return i}function de(e){const t=ce(8,null,!1);return vt(t,y),t.teardown=e,t}function fe(e){if(ue(),!(null!==Ue&&0!==(Ue.f&p)&&null!==q&&!q.m))return ve(e);var t=q;(t.e??=[]).push({fn:e,effect:Ue,reaction:Pe})}function ve(e){return ce(4,e,!1)}function pe(e,t){var n=q,o={effect:null,ran:!1};n.l.r1.push(o),o.effect=ge((()=>{e(),o.ran||(o.ran=!0,Y(n.l.r2,!0),dt(t))}))}function me(){var e=q;ge((()=>{if(ct(e.l.r2)){for(var t of e.l.r1){var n=t.effect;0!==(n.f&y)&&vt(n,b),Qe(n)&&lt(n),t.ran=!1}e.l.r2.v=!1}}))}function ge(e){return ce(8,e,!0)}function he(e,t=[],n=W){const o=t.map(n);return ye((()=>e(...o.map(ct))))}function ye(e,t=0){return ce(24|t,e,!0)}function we(e,t=!0){return ce(40,e,!0,t)}function be(e){var t=e.teardown;if(null!==t){const e=Oe,n=Pe;Ne(!0),We(null);try{t.call(null)}finally{Ne(e),We(n)}}}function ze(e,t=!1){var n=e.first;for(e.first=e.last=null;null!==n;){var o=n.next;0!==(n.f&m)?n.parent=null:Se(n,t),n=o}}function Se(e,t=!0){var n=!1;(t||524288&e.f)&&null!==e.nodes_start&&null!==e.nodes_end&&(!function(e,t){for(;null!==e;){var n=e===t?null:ie(e);e.remove(),e=n}}(e.nodes_start,e.nodes_end),n=!0),ze(e,t&&!n),ot(e,0),vt(e,S);var o=e.transitions;if(null!==o)for(const e of o)e.stop();be(e);var l=e.parent;null!==l&&null!==l.first&&xe(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=null}function xe(e){var t=e.parent,n=e.prev,o=e.next;null!==n&&(n.next=o),null!==o&&(o.prev=n),null!==t&&(t.first===e&&(t.first=o),t.last===e&&(t.last=n))}function Me(e,t){var n=[];De(e,n,!0),ke(n,(()=>{Se(e),t&&t()}))}function ke(e,t){var n=e.length;if(n>0){var o=()=>--n||t();for(var l of e)l.out(o)}else t()}function De(e,t,n){if(0===(e.f&z)){if(e.f^=z,null!==e.transitions)for(const o of e.transitions)(o.is_global||n)&&t.push(o);for(var o=e.first;null!==o;){var l=o.next;De(o,t,!!(0!==(o.f&x)||0!==(o.f&p))&&n),o=l}}}function _e(e){$e(e,!0)}function $e(e,t){if(0!==(e.f&z)){e.f^=z,0===(e.f&y)&&(e.f^=y),Qe(e)&&(vt(e,w),st(e));for(var n=e.first;null!==n;){var o=n.next;$e(n,!!(0!==(n.f&x)||0!==(n.f&p))&&t),n=o}if(null!==e.transitions)for(const n of e.transitions)(n.is_global||t)&&n.in()}}let Ee=[];function Ce(){var e=Ee;Ee=[],v(e)}function Le(e){0===Ee.length&&queueMicrotask(Ce),Ee.push(e)}function Te(e,t){for(;null!==t;){if(128&t.f)try{return void t.fn(e)}catch{}t=t.parent}throw e}let Re=!1,qe=null,je=!1,Oe=!1;function Ne(e){Oe=e}let Ae=[],Pe=null,Ie=!1;function We(e){Pe=e}let Ue=null;function Be(e){Ue=e}let Fe=null;function He(e){null!==Pe&&Pe.f&k&&(null===Fe?Fe=[e]:Fe.push(e))}let Je=null,Ve=0,Ze=null;let Xe=1,Ye=0,Ge=!1;function Ke(){return++Xe}function Qe(e){var t=e.f;if(0!==(t&w))return!0;if(0!==(t&b)){var n=e.deps,o=0!==(t&g);if(null!==n){var l,i,r=0!==(t&h),a=o&&null!==Ue&&!Ge,s=n.length;if(r||a){var u=e,c=u.parent;for(l=0;l<s;l++)i=n[l],!r&&i?.reactions?.includes(u)||(i.reactions??=[]).push(u);r&&(u.f^=h),a&&null!==c&&0===(c.f&g)&&(u.f^=g)}for(l=0;l<s;l++)if(Qe(i=n[l])&&H(i),i.wv>e.wv)return!0}o&&(null===Ue||Ge)||vt(e,y)}return!1}function et(e,t,n=!0){var o=e.reactions;if(null!==o)for(var l=0;l<o.length;l++){var i=o[l];Fe?.includes(e)||(2&i.f?et(i,t,!1):t===i&&(n?vt(i,w):0!==(i.f&y)&&vt(i,b),st(i)))}}function tt(e){var t=Je,n=Ve,o=Ze,l=Pe,i=Ge,r=Fe,a=q,s=Ie,u=e.f;Je=null,Ve=0,Ze=null,Ge=0!==(u&g)&&(Ie||!je||null===Pe),Pe=96&u?null:e,Fe=null,j(e.ctx),Ie=!1,Ye++,e.f|=k;try{var c=(0,e.fn)(),d=e.deps;if(null!==Je){var f;if(ot(e,Ve),null!==d&&Ve>0)for(d.length=Ve+Je.length,f=0;f<Je.length;f++)d[Ve+f]=Je[f];else e.deps=d=Je;if(!Ge)for(f=Ve;f<d.length;f++)(d[f].reactions??=[]).push(e)}else null!==d&&Ve<d.length&&(ot(e,Ve),d.length=Ve);if(A()&&null!==Ze&&!Ie&&null!==d&&!(6146&e.f))for(f=0;f<Ze.length;f++)et(Ze[f],e);return null!==l&&l!==e&&(Ye++,null!==Ze&&(null===o?o=Ze:o.push(...Ze))),c}catch(e){!function(e){var t=Ue;if(32768&t.f)Te(e,t);else{if(!(128&t.f))throw e;t.fn(e)}}(e)}finally{Je=t,Ve=n,Ze=o,Pe=l,Ge=i,Fe=r,j(a),Ie=s,e.f^=k}}function nt(e,t){let o=t.reactions;if(null!==o){var l=n.call(o,e);if(-1!==l){var i=o.length-1;0===i?o=t.reactions=null:(o[l]=o[i],o.pop())}}null===o&&2&t.f&&(null===Je||!Je.includes(t))&&(vt(t,b),768&t.f||(t.f^=h),B(t),ot(t,0))}function ot(e,t){var n=e.deps;if(null!==n)for(var o=t;o<n.length;o++)nt(e,n[o])}function lt(t){var n=t.f;if(0===(n&S)){vt(t,y);var o=Ue,l=je;Ue=t,je=!0;try{16&n?function(e){for(var t=e.first;null!==t;){var n=t.next;0===(t.f&p)&&Se(t),t=n}}(t):ze(t),be(t);var i=tt(t);t.teardown="function"==typeof i?i:null,t.wv=Xe;t.deps;e}finally{je=l,Ue=o}}}function it(){try{!function(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}()}catch(e){if(null===qe)throw e;Te(e,qe)}}function rt(){var e=je;try{var t=0;for(je=!0;Ae.length>0;){t++>1e3&&it();var n=Ae,o=n.length;Ae=[];for(var l=0;l<o;l++){at(ut(n[l]))}J.clear()}}finally{Re=!1,je=e,qe=null}}function at(e){var t=e.length;if(0!==t)for(var n=0;n<t;n++){var o=e[n];24576&o.f||Qe(o)&&(lt(o),null===o.deps&&null===o.first&&null===o.nodes_start&&(null===o.teardown?xe(o):o.fn=null))}}function st(e){Re||(Re=!0,queueMicrotask(rt));for(var t=qe=e;null!==t.parent;){var n=(t=t.parent).f;if(96&n){if(0===(n&y))return;t.f^=y}}Ae.push(t)}function ut(e){for(var t=[],n=e;null!==n;){var o=n.f,l=!!(96&o);if(!(l&&0!==(o&y))&&0===(o&z)){4&o?t.push(n):l?n.f^=y:Qe(n)&&lt(n);var i=n.first;if(null!==i){n=i;continue}}var r=n.parent;for(n=n.next;null===n&&null!==r;)n=r.next,r=r.parent}return t}function ct(e){var t=!!(2&e.f);if(null===Pe||Ie){if(t&&null===e.deps&&null===e.effects){var n=e,o=n.parent;null!==o&&0===(o.f&g)&&(n.f^=g)}}else if(!Fe?.includes(e)){var l=Pe.deps;e.rv<Ye&&(e.rv=Ye,null===Je&&null!==l&&l[Ve]===e?Ve++:null===Je?Je=[e]:Ge&&Je.includes(e)||Je.push(e))}return t&&Qe(n=e)&&H(n),Oe&&J.has(e)?J.get(e):e.v}function dt(e){var t=Ie;try{return Ie=!0,e()}finally{Ie=t}}const ft=-7169;function vt(e,t){e.f=e.f&ft|t}function pt(e){if("object"==typeof e&&e&&!(e instanceof EventTarget))if(D in e)mt(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];"object"==typeof n&&n&&D in n&&mt(n)}}function mt(e,t=new Set){if(!("object"!=typeof e||null===e||e instanceof EventTarget||t.has(e))){t.add(e),e instanceof Date&&e.getTime();for(let n in e)try{mt(e[n],t)}catch(e){}const n=u(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const t=r(n);for(let n in t){const o=t[n].get;if(o)try{o.call(e)}catch(e){}}}}}const gt=["touchstart","touchmove"];function ht(e){return gt.includes(e)}let yt=!1;function wt(e){var t=Pe,n=Ue;We(null),Be(null);try{return e()}finally{We(t),Be(n)}}function bt(e,t,n,o=n){e.addEventListener(t,(()=>wt(n)));const l=e.__on_r;e.__on_r=l?()=>{l(),o(!0)}:()=>o(!0),yt||(yt=!0,document.addEventListener("reset",(e=>{Promise.resolve().then((()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()}))}),{capture:!0}))}const zt=new Set,St=new Set;function xt(e,t,n,o,l){var i={capture:o,passive:l},r=function(e,t,n,o={}){function l(e){if(o.capture||Mt.call(t,e),!e.cancelBubble)return wt((()=>n?.call(this,e)))}return e.startsWith("pointer")||e.startsWith("touch")||"wheel"===e?Le((()=>{t.addEventListener(e,l,o)})):t.addEventListener(e,l,o),l}(e,t,n,i);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&de((()=>{t.removeEventListener(e,r,i)}))}function Mt(e){var n=this,o=n.ownerDocument,i=e.type,r=e.composedPath?.()||[],a=r[0]||e.target,s=0,u=e.__root;if(u){var c=r.indexOf(u);if(-1!==c&&(n===document||n===window))return void(e.__root=n);var d=r.indexOf(n);if(-1===d)return;c<=d&&(s=c)}if((a=r[s]||e.target)!==n){l(e,"currentTarget",{configurable:!0,get:()=>a||o});var f=Pe,v=Ue;We(null),Be(null);try{for(var p,m=[];null!==a;){var g=a.assignedSlot||a.parentNode||a.host||null;try{var h=a["__"+i];if(null!=h&&(!a.disabled||e.target===a))if(t(h)){var[y,...w]=h;y.apply(a,[e,...w])}else h.call(a,e)}catch(e){p?m.push(e):p=e}if(e.cancelBubble||g===n||null===g)break;a=g}if(p){for(let e of m)queueMicrotask((()=>{throw e}));throw p}}finally{e.__root=n,delete e.currentTarget,We(f),Be(v)}}}function kt(e,t){var n=Ue;null===n.nodes_start&&(n.nodes_start=e,n.nodes_end=t)}function Dt(e,t){var n,o=!!(1&t),l=!!(2&t),i=!e.startsWith("<!>");return()=>{var t,r;void 0===n&&(t=i?e:"<!>"+e,(r=document.createElement("template")).innerHTML=t.replaceAll("<!>","\x3c!----\x3e"),n=r.content,o||(n=le(n)));var a=l||ee?document.importNode(n,!0):n.cloneNode(!0);o?kt(le(a),a.lastChild):kt(a,a);return a}}function _t(e=""){var t=oe(e+"");return kt(t,t),t}function $t(e,t){null!==e&&e.before(t)}function Et(e,t){var n=null==t?"":"object"==typeof t?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}const Ct=new Map;let Lt=new WeakMap;function Tt(e,t,[n,o]=[0,0]){var l=e,i=null,r=null,a=T,s=!1;const u=(e,t=!0)=>{s=!0,c(t,e)},c=(e,t)=>{a!==(a=e)&&(a?(i?_e(i):t&&(i=we((()=>t(l)))),r&&Me(r,(()=>{r=null}))):(r?_e(r):t&&(r=we((()=>t(l,[n+1,o])))),i&&Me(i,(()=>{i=null}))))};ye((()=>{s=!1,t(u),s||c(null,null)}),n>0?x:0)}function Rt(e,t){return t}function qt(e,n,l,i,r,a=null){var s=e,u={flags:n,items:new Map,first:null},c=null,d=!1,f=U((()=>{var e=l();return t(e)?e:null==e?[]:o(e)}));ye((()=>{var e=ct(f),t=e.length;d&&0===t||(d=0===t,function(e,t,n,l,i,r,a){var s,u,c,d,f,v=e.length,p=t.items,m=t.first,g=m,h=null,y=[],w=[];for(f=0;f<v;f+=1)if(c=r(u=e[f],f),void 0!==(d=p.get(c))){if(jt(d,u,f),0!==(d.e.f&z)&&_e(d.e),d!==g){if(void 0!==s&&s.has(d)){if(y.length<w.length){var b,S=w[0];h=S.prev;var x=y[0],M=y[y.length-1];for(b=0;b<y.length;b+=1)Nt(y[b],S,n);for(b=0;b<w.length;b+=1)s.delete(w[b]);At(t,x.prev,M.next),At(t,h,x),At(t,M,S),g=S,h=M,f-=1,y=[],w=[]}else s.delete(d),Nt(d,g,n),At(t,d.prev,d.next),At(t,d,null===h?t.first:h.next),At(t,h,d),h=d;continue}for(y=[],w=[];null!==g&&g.k!==c;)0===(g.e.f&z)&&(s??=new Set).add(g),w.push(g),g=g.next;if(null===g)continue;d=g}y.push(d),h=d,g=d.next}else{h=Ot(g?g.e.nodes_start:n,t,h,null===h?t.first:h.next,u,c,f,l,i,a),p.set(c,h),y=[],w=[],g=h.next}if(null!==g||void 0!==s){for(var k=void 0===s?[]:o(s);null!==g;)0===(g.e.f&z)&&k.push(g),g=g.next;if(k.length>0)!function(e,t,n,o){for(var l=[],i=t.length,r=0;r<i;r++)De(t[r].e,l,!0);var a=i>0&&0===l.length&&null!==n;if(a){var s=n.parentNode;s.textContent="",s.append(n),o.clear(),At(e,t[0].prev,t[i-1].next)}ke(l,(()=>{for(var n=0;n<i;n++){var l=t[n];a||(o.delete(l.k),At(e,l.prev,l.next)),Se(l.e,!a)}}))}(t,k,null,p)}Ue.first=t.first&&t.first.e,Ue.last=h&&h.e}(e,u,s,r,n,i,l),null!==a&&(0===t?c?_e(c):c=we((()=>a(s))):null!==c&&Me(c,(()=>{c=null}))),ct(f))}))}function jt(e,t,n,o){G(e.v,t),e.i=n}function Ot(e,t,n,o,l,i,r,a,s,u){var c=!!(1&s)?!(16&s)?X(l):V(l):l,d=2&s?V(r):r,f={i:d,v:c,k:i,a:null,e:null,prev:n,next:o};try{return f.e=we((()=>a(e,c,d,u)),false),f.e.prev=n&&n.e,f.e.next=o&&o.e,null===n?t.first=f:(n.next=f,n.e.next=f.e),null!==o&&(o.prev=f,o.e.prev=f.e),f}finally{}}function Nt(e,t,n){for(var o=e.next?e.next.e.nodes_start:n,l=t?t.e.nodes_start:n,i=e.e.nodes_start;i!==o;){var r=ie(i);l.before(i),i=r}}function At(e,t,n){null===t?e.first=n:(t.next=n,t.e.next=n&&n.e),null!==n&&(n.prev=t,n.e.prev=t&&t.e)}const Pt=[..." \t\n\r\f \v\ufeff"];function It(e,t,n,o,l,i){var r=e.__className;if(r!==n||void 0===r){var a=function(e,t,n){var o=null==e?"":""+e;if(n)for(var l in n)if(n[l])o=o?o+" "+l:l;else if(o.length)for(var i=l.length,r=0;(r=o.indexOf(l,r))>=0;){var a=r+i;0!==r&&!Pt.includes(o[r-1])||a!==o.length&&!Pt.includes(o[a])?r=a:o=(0===r?"":o.substring(0,r))+o.substring(a+1)}return""===o?null:o}(n,0,i);null==a?e.removeAttribute("class"):e.className=a,e.__className=n}else if(i&&l!==i)for(var s in i){var u=!!i[s];null!=l&&u===!!l[s]||e.classList.toggle(s,u)}return i}function Wt(e,t,n,o){if(e.__style!==t){var l=function(e){return null==e?null:String(e)}(t);null==l?e.removeAttribute("style"):e.style.cssText=l,e.__style=t}return o}function Ut(e){var t=e.type;return"number"===t||"range"===t}function Bt(e){return""===e?null:+e}function Ft(e,t){return e===t||e?.[D]===t}function Ht(e={},t,n,o){return ve((()=>{var o,l;return ge((()=>{o=l,l=[],dt((()=>{e!==n(...l)&&(t(e,...l),o&&Ft(n(...o),e)&&t(null,...o))}))})),()=>{Le((()=>{l&&Ft(n(...l),e)&&t(null,...l)}))}})),e}function Jt(e){return function(...t){return t[0].stopPropagation(),e?.apply(this,t)}}function Vt(e=!1){const t=q,n=t.l.u;if(!n)return;let o=()=>pt(t.s);if(e){let e=0,n={};const l=W((()=>{let o=!1;const l=t.s;for(const e in l)l[e]!==n[e]&&(n[e]=l[e],o=!0);return o&&e++,e}));o=()=>ct(l)}var l;n.b.length&&(l=()=>{Zt(t,o),v(n.b)},ue(),ge(l)),fe((()=>{const e=dt((()=>n.m.map(f)));return()=>{for(const t of e)"function"==typeof t&&t()}})),n.a.length&&fe((()=>{Zt(t,o),v(n.a)}))}function Zt(e,t){if(e.l.s)for(const t of e.l.s)ct(t);t()}const Xt=[];function Yt(e,t=d){let n=null;const o=new Set;function l(t){if(E(e,t)&&(e=t,n)){const t=!Xt.length;for(const t of o)t[1](),Xt.push(t,e);if(t){for(let e=0;e<Xt.length;e+=2)Xt[e][0](Xt[e+1]);Xt.length=0}}}function i(t){l(t(e))}return{set:l,update:i,subscribe:function(r,a=d){const s=[r,a];return o.add(s),1===o.size&&(n=t(l,i)||d),r(e),()=>{o.delete(s),0===o.size&&n&&(n(),n=null)}}}}let Gt=!1;function Kt(e){return e.ctx?.d??!1}function Qt(e,t,n,o){var l,r=!!(1&n),a=!L||!!(2&n),s=!!(8&n),u=!!(16&n),c=!1;s?[l,c]=function(e){var t=Gt;try{return Gt=!1,[e(),Gt]}finally{Gt=t}}((()=>e[t])):l=e[t];var d,f=D in e||_ in e,v=s&&(i(e,t)?.set??(f&&t in e&&(n=>e[t]=n)))||void 0,p=o,m=!0,g=!1,h=()=>(g=!0,m&&(m=!1,p=u?dt(o):o),p);if(void 0===l&&void 0!==o&&(v&&a&&function(){throw new Error("https://svelte.dev/e/props_invalid_value")}(),l=h(),v&&v(l)),a)d=()=>{var n=e[t];return void 0===n?h():(m=!0,g=!1,n)};else{var y=(r?W:U)((()=>e[t]));y.f|=131072,d=()=>{var e=ct(y);return void 0!==e&&(p=void 0),void 0===e?p:e}}if(!(4&n)&&a)return d;if(v){var w=e.$$legacy;return function(e,t){return arguments.length>0?(a&&t&&!w&&!c||v(t?d():e),e):d()}}var b=!1,z=X(l),S=W((()=>{var e=d(),t=ct(z);return b?(b=!1,t):z.v=e}));return s&&ct(S),r||(S.equals=C),function(e,t){if(arguments.length>0){const n=t?ct(S):a&&s?P(e):e;if(!S.equals(n)){if(b=!0,Y(z,n),g&&void 0!==p&&(p=n),Kt(S))return e;dt((()=>ct(S)))}return e}return Kt(S)?S.v:ct(S)}}function en(e){var t,n;null===q&&R(),L&&null!==q.l?(t=q,n=t.l,n.u??={a:[],b:[],m:[]}).m.push(e):fe((()=>{const t=dt(e);if("function"==typeof t)return t}))}function tn(e){null===q&&R(),en((()=>()=>dt(e)))}function nn(){const e=q;return null===e&&R(),(n,o,l)=>{const i=e.s.$$events?.[n];if(i){const r=t(i)?i.slice():[i],a=function(e,t,{bubbles:n=!1,cancelable:o=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:o})}(n,o,l);for(const t of r)t.call(e.x,a);return!a.defaultPrevented}return!0}}"undefined"!=typeof window&&((window.__svelte??={}).v??=new Set).add("5"),L=!0;const on=new class{constructor(){this.baseUrl="/api/documents",this.cache=new Map,this.cacheTimeout=3e5,this.listeners=new Set,this.ws=null,this.wsReconnectAttempts=0,this.wsMaxReconnectAttempts=5,this.wsReconnectDelay=1e3,this.initWebSocket(),console.log("📄 DocumentService frontend inizializzato")}initWebSocket(){try{const e=`${"https:"===window.location.protocol?"wss:":"ws:"}//${window.location.host}`;this.ws=new WebSocket(e),this.ws.onopen=()=>{console.log("📡 WebSocket connesso per DocumentService"),this.wsReconnectAttempts=0,this.ws.send(JSON.stringify({type:"subscribe",pattern:{entityType:"CompositeDocument"}})),this.ws.send(JSON.stringify({type:"subscribe",pattern:{relationType:"CONTAINS_MODULE"}}))},this.ws.onmessage=e=>{try{const t=JSON.parse(e.data);this.handleWebSocketMessage(t)}catch(e){console.error("Errore parsing WebSocket message:",e)}},this.ws.onclose=()=>{console.log("📡 WebSocket disconnesso"),this.scheduleReconnect()},this.ws.onerror=e=>{console.error("Errore WebSocket:",e)}}catch(e){console.error("Errore inizializzazione WebSocket:",e),this.scheduleReconnect()}}scheduleReconnect(){if(this.wsReconnectAttempts<this.wsMaxReconnectAttempts){this.wsReconnectAttempts++;const e=this.wsReconnectDelay*Math.pow(2,this.wsReconnectAttempts-1);console.log(`📡 Riconnessione WebSocket in ${e}ms (tentativo ${this.wsReconnectAttempts})`),setTimeout((()=>{this.initWebSocket()}),e)}}handleWebSocketMessage(e){"change"===e.type&&("CompositeDocument"===e.entityType&&this.invalidateCache(e.entityId),this.notifyListeners(e))}addListener(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach((t=>{try{t(e)}catch(e){console.error("Errore notifica listener:",e)}}))}async makeRequest(e,t={}){try{const n=await fetch(e,{headers:{"Content-Type":"application/json",...t.headers},...t});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const o=await n.json();return o.success?o.data:o}catch(t){throw console.error(`Errore richiesta ${e}:`,t),t}}getCached(e){const t=this.cache.get(e);return t&&Date.now()-t.timestamp<this.cacheTimeout?t.data:(this.cache.delete(e),null)}setCached(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}invalidateCache(e=null){e?(this.cache.delete(`document:${e}`),this.cache.delete("documents:list")):this.cache.clear()}async getDocuments(){const e="documents:list",t=this.getCached(e);if(t)return t;const n=await this.makeRequest(this.baseUrl);return this.setCached(e,n),n}async getDocument(e){const t=`document:${e}`,n=this.getCached(t);if(n)return n;const o=await this.makeRequest(`${this.baseUrl}/${e}`);return this.setCached(t,o),o}async createDocument(e){const t=await this.makeRequest(this.baseUrl,{method:"POST",body:JSON.stringify(e)});return this.invalidateCache(),t}async updateDocument(e,t){const n=await this.makeRequest(`${this.baseUrl}/${e}`,{method:"PUT",body:JSON.stringify(t)});return this.invalidateCache(e),n}async deleteDocument(e){return await this.makeRequest(`${this.baseUrl}/${e}`,{method:"DELETE"}),this.invalidateCache(e),!0}async updateDocumentModules(e,t,n,o={}){const l=await this.makeRequest(`${this.baseUrl}/${e}/modules`,{method:"PUT",body:JSON.stringify({action:t,moduleId:n,layoutConfig:o})});return this.invalidateCache(e),l}async addModule(e,t,n={},o={}){const l=`${t}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,i={position:{x:n.x||0,y:n.y||0},size:{w:n.w||4,h:n.h||3},type:t,config:o};return await this.updateDocumentModules(e,"add",l,i)}async removeModule(e,t){return await this.updateDocumentModules(e,"remove",t)}async updateModuleLayout(e,t,n){return await this.updateDocumentModules(e,"update",t,n)}async saveDocumentLayout(e,t){return await this.updateDocument(e,{layout:t})}cleanup(){this.ws&&(this.ws.close(),this.ws=null),this.cache.clear(),this.listeners.clear()}};"undefined"!=typeof window&&window.addEventListener("beforeunload",(()=>{on.cleanup()}));const ln=Yt({document:null,modules:[],loading:!1,error:null});on.addListener((e=>{"change"===e.type&&"CompositeDocument"===e.entityType&&(console.log("📡 Documento aggiornato via WebSocket:",e.entityId),ln.update((t=>(t.document&&t.document.id===e.entityId&&rn.loadDocument(e.entityId).catch(console.error),t))))}));const rn={async loadDocument(e){ln.update((e=>({...e,loading:!0,error:null})));try{const t=await on.getDocument(e);return ln.update((e=>({...e,document:t,modules:t.modules||[],loading:!1,error:null}))),console.log("📄 Documento caricato:",t.name),t}catch(e){throw console.error("Errore caricamento documento:",e),ln.update((t=>({...t,loading:!1,error:e.message}))),e}},async createDocument(e){try{const t=await on.createDocument(e);return ln.update((e=>({...e,document:t,modules:[],error:null}))),console.log("📄 Documento creato:",t.name),t}catch(e){throw console.error("Errore creazione documento:",e),ln.update((t=>({...t,error:e.message}))),e}},async addModule(e,t,n={}){try{const o=await on.addModule(e,t,n);return await rn.loadDocument(e),console.log("🧩 Modulo aggiunto:",t),o}catch(e){throw console.error("Errore aggiunta modulo:",e),e}},async removeModule(e,t){try{await on.removeModule(e,t),await rn.loadDocument(e),console.log("🗑️ Modulo rimosso:",t)}catch(e){throw console.error("Errore rimozione modulo:",e),e}},async updateModuleLayout(e,t,n){try{await on.updateModuleLayout(e,t,n),ln.update((e=>({...e,modules:e.modules.map((e=>e.id===t?{...e,layoutConfig:{...e.layoutConfig,...n}}:e))}))),console.log("📐 Layout modulo aggiornato:",t)}catch(e){throw console.error("Errore aggiornamento layout:",e),e}},clear(){ln.set({document:null,modules:[],loading:!1,error:null})}};ln.loadDocument=rn.loadDocument,ln.createDocument=rn.createDocument,ln.addModule=rn.addModule,ln.removeModule=rn.removeModule,ln.updateModuleLayout=rn.updateModuleLayout,ln.clear=rn.clear;const an=Yt({documentId:null,layout:{gridSize:12,cellHeight:60,margin:[10,10],containerPadding:[20,20],breakpoints:{lg:1200,md:996,sm:768,xs:480}},modules:new Map,selection:null,isDragging:!1,isResizing:!1,viewMode:"edit",zoom:1,autoSave:!0,lastSaved:null}),sn={initializeForDocument(e,t=null){an.update((t=>({...t,documentId:e,modules:new Map,selection:null,isDragging:!1,isResizing:!1,lastSaved:null}))),t?.layout&&an.update((e=>({...e,layout:{...e.layout,...t.layout}}))),console.log("🏗️ Workspace inizializzato per documento:",e)},updateModuleLayout(e,t){an.update((n=>{const o=new Map(n.modules),l=o.get(e)||{};return o.set(e,{...l,...t,lastModified:Date.now()}),{...n,modules:o,lastSaved:null}}));const n=un(an);n.autoSave&&n.documentId&&this.debouncedSave(n.documentId)},selectModule(e){an.update((t=>({...t,selection:e})))},clearSelection(){an.update((e=>({...e,selection:null})))},setDragging(e,t=null){an.update((n=>({...n,isDragging:e,selection:e?t:n.selection})))},setResizing(e,t=null){an.update((n=>({...n,isResizing:e,selection:e?t:n.selection})))},setViewMode(e){an.update((t=>({...t,viewMode:e,selection:"edit"===e?t.selection:null})))},setZoom(e){const t=Math.max(.25,Math.min(2,e));an.update((e=>({...e,zoom:t})))},async saveLayout(e){const t=un(an);try{const n={};t.modules.forEach(((e,t)=>{n[t]=e}));const o={layout:{...t.layout,modules:n}},l=await fetch(`/api/documents/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!l.ok)throw new Error(`Errore salvataggio layout: ${l.statusText}`);return an.update((e=>({...e,lastSaved:Date.now()}))),console.log("💾 Layout salvato per documento:",e),!0}catch(e){throw console.error("Errore salvataggio layout:",e),e}},debouncedSave:(()=>{let e;return t=>{clearTimeout(e),e=setTimeout((()=>{(void 0).saveLayout(t).catch(console.error)}),2e3)}})(),reset(){an.set({documentId:null,layout:{gridSize:12,cellHeight:60,margin:[10,10],containerPadding:[20,20],breakpoints:{lg:1200,md:996,sm:768,xs:480}},modules:new Map,selection:null,isDragging:!1,isResizing:!1,viewMode:"edit",zoom:1,autoSave:!0,lastSaved:null})},getResponsiveLayout(e){const t=un(an),n=[];return t.modules.forEach(((e,t)=>{n.push({i:t,x:e.x||0,y:e.y||0,w:e.w||4,h:e.h||3,minW:e.minW||2,minH:e.minH||2,maxW:e.maxW||12,maxH:e.maxH||10})})),n}};function un(e){let t;return e.subscribe((e=>t=e))(),t}an.initializeForDocument=sn.initializeForDocument,an.updateModuleLayout=sn.updateModuleLayout,an.selectModule=sn.selectModule,an.clearSelection=sn.clearSelection,an.setDragging=sn.setDragging,an.setResizing=sn.setResizing,an.setViewMode=sn.setViewMode,an.setZoom=sn.setZoom,an.saveLayout=sn.saveLayout,an.reset=sn.reset,an.getResponsiveLayout=sn.getResponsiveLayout;var cn=Dt('<div class="document-info svelte-fftuim"><h1 class="document-title svelte-fftuim"> </h1> <p class="document-description svelte-fftuim"> </p></div>'),dn=Dt('<div class="document-info svelte-fftuim"><h1 class="document-title svelte-fftuim">SSOT-4000 Workspace</h1> <p class="document-description svelte-fftuim">Nessun documento caricato</p></div>'),fn=Dt('<span class="last-saved svelte-fftuim"> </span>'),vn=Dt("<button><!></button> <!>",1),pn=Dt('<button class="create-btn svelte-fftuim">📄 Nuovo Documento</button>'),mn=Dt('<header class="workspace-header svelte-fftuim"><div class="header-left svelte-fftuim"><!></div> <div class="header-center svelte-fftuim"><div class="view-mode-selector svelte-fftuim"><button title="Modalità Modifica">✏️ Modifica</button> <button title="Modalità Anteprima">👁️ Anteprima</button> <button title="Modalità Presentazione">📺 Presenta</button></div></div> <div class="header-right svelte-fftuim"><div class="zoom-controls svelte-fftuim"><button class="zoom-btn svelte-fftuim" title="Zoom Out">🔍−</button> <span class="zoom-level svelte-fftuim"> </span> <button class="zoom-btn svelte-fftuim" title="Zoom In">🔍+</button></div> <div class="save-controls svelte-fftuim"><!></div></div></header>');function gn(e,t){O(t,!1);let n=Qt(t,"document",8,null);const o=nn();let l=X({}),i=X(null),r=X("saved");function a(){n()&&(Y(r,"saving"),o("save"))}function s(e){an.setViewMode(e)}function u(e){const t=ct(l).zoom||1,n="in"===e?1.2*t:t/1.2;an.setZoom(n)}function c(){o("create")}an.subscribe((e=>{Y(l,e),Y(i,e.lastSaved),e.lastSaved?Y(r,"saved"):e.documentId&&e.modules.size>0&&Y(r,"unsaved")})),Vt();var d=mn(),f=re(d),v=re(f),p=e=>{var t=cn(),o=re(t),l=re(o),i=re(se(o,2));he((()=>{Et(l,n().name),Et(i,n().description||"Nessuna descrizione")})),$t(e,t)},m=e=>{$t(e,dn())};Tt(v,(e=>{n()?e(p):e(m,!1)}));var g=se(f,2),h=re(g),y=re(h);let w;var b=se(y,2);let z;var S=se(b,2);let x;var M=re(se(g,2)),k=re(M),D=se(k,2),_=re(D),$=se(D,2),E=re(se(M,2)),C=e=>{var t=vn(),n=ae(t);let o;var l=re(n),s=e=>{$t(e,_t("⏳ Salvataggio..."))},u=(e,t)=>{var n=e=>{$t(e,_t("✅ Salvato"))},o=e=>{$t(e,_t("💾 Salva"))};Tt(e,(e=>{"saved"===ct(r)?e(n):e(o,!1)}),t)};Tt(l,(e=>{"saving"===ct(r)?e(s):e(u,!1)}));var c=se(n,2),d=e=>{var t=fn(),n=re(t);he((e=>Et(n,`Ultimo salvataggio: ${e??""}`)),[()=>{return(e=ct(i))?new Date(e).toLocaleTimeString():"";var e}],U),$t(e,t)};Tt(c,(e=>{ct(i)&&e(d)})),he((e=>{o=It(n,0,"save-btn svelte-fftuim",0,o,e),n.disabled="saving"===ct(r)}),[()=>({saving:"saving"===ct(r)})],U),xt("click",n,a),$t(e,t)},L=e=>{var t=pn();xt("click",t,c),$t(e,t)};Tt(E,(e=>{n()?e(C):e(L,!1)})),he(((e,t,n,o)=>{w=It(y,0,"mode-btn svelte-fftuim",0,w,e),z=It(b,0,"mode-btn svelte-fftuim",0,z,t),x=It(S,0,"mode-btn svelte-fftuim",0,x,n),Et(_,`${o??""}%`)}),[()=>({active:"edit"===ct(l).viewMode}),()=>({active:"preview"===ct(l).viewMode}),()=>({active:"present"===ct(l).viewMode}),()=>Math.round(100*(ct(l).zoom||1))],U),xt("click",y,(()=>s("edit"))),xt("click",b,(()=>s("preview"))),xt("click",S,(()=>s("present"))),xt("click",k,(()=>u("out"))),xt("click",$,(()=>u("in"))),$t(e,d),N()}var hn=Dt('<div class="module-header svelte-1ki5div"><div class="module-title svelte-1ki5div"><span class="module-icon svelte-1ki5div">🧩</span> <span class="module-name svelte-1ki5div"> </span></div> <div class="module-actions svelte-1ki5div"><button class="action-btn settings-btn svelte-1ki5div" title="Impostazioni">⚙️</button> <button class="action-btn remove-btn svelte-1ki5div" title="Rimuovi">✕</button></div></div>'),yn=Dt('<details class="svelte-1ki5div"><summary>Configurazione</summary> <pre class="svelte-1ki5div"> </pre></details>'),wn=Dt('<div class="module-placeholder svelte-1ki5div"><div class="placeholder-icon svelte-1ki5div">🧩</div> <h4 class="svelte-1ki5div"> </h4> <p class="svelte-1ki5div"> </p> <p class="svelte-1ki5div"> </p> <!></div>'),bn=Dt('<div class="module-error svelte-1ki5div"><p>❌ Modulo non disponibile</p></div>'),zn=Dt('<div class="resize-handle svelte-1ki5div"></div>'),Sn=Dt('<div class="selection-outline svelte-1ki5div"></div>'),xn=Dt('<div><!> <div class="module-content svelte-1ki5div"><!></div> <!> <!></div>');function Mn(e,t){O(t,!1);const n=X(),o=X(),l=X(),i=X(),r=X(),a=X();let s=Qt(t,"module",8,null),u=Qt(t,"layoutConfig",24,(()=>({}))),c=Qt(t,"isSelected",8,!1),d=Qt(t,"isDragging",8,!1),f=Qt(t,"isResizing",8,!1),v=Qt(t,"viewMode",8,"edit");Qt(t,"documentContext",24,(()=>({})));const p=nn();let m,g=X(),h=X(),y={x:0,y:0};function w(e){if(!d())return;const t=document.querySelector(".grid-container");if(!t)return;const n=t.getBoundingClientRect(),o={x:Math.max(0,Math.round((e.clientX-n.left-y.x)/100)),y:Math.max(0,Math.round((e.clientY-n.top-y.y)/ct(i)))};p("update",{moduleId:s().id,layoutConfig:{...u(),position:o}})}function b(){an.setDragging(!1),document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",b)}function z(e){if(!f())return;const t=e.movementX,n=e.movementY,l={w:Math.max(2,ct(o).w+Math.round(t/50)),h:Math.max(2,ct(o).h+Math.round(n/30))};p("update",{moduleId:s().id,layoutConfig:{...u(),size:l}})}function S(){an.setResizing(!1),document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",S)}function x(){confirm(`Rimuovere il modulo "${s().name||s().type}"?`)&&p("remove",{moduleId:s().id})}function M(){console.log("🔧 Apri impostazioni modulo:",s().id)}function k(e){return e.name||e.type||"Modulo Senza Nome"}en((()=>{ct(g)&&(m=new ResizeObserver((e=>{})),m.observe(ct(g)))})),tn((()=>{m&&m.disconnect()})),pe((()=>pt(u())),(()=>{Y(n,u().position||{x:0,y:0})})),pe((()=>pt(u())),(()=>{Y(o,u().size||{w:4,h:3})})),pe((()=>{}),(()=>{Y(l,12)})),pe((()=>{}),(()=>{Y(i,60)})),pe((()=>(ct(o),ct(l))),(()=>{Y(r,ct(o).w/ct(l)*100)})),pe((()=>(ct(o),ct(i))),(()=>{Y(a,ct(o).h*ct(i))})),me(),Vt();var D=xn();let _;var $=re(D),E=e=>{var t=hn(),n=re(t),o=se(re(n),2),l=re(o),i=re(se(n,2)),r=se(i,2);Ht(t,(e=>Y(h,e)),(()=>ct(h))),he((e=>Et(l,e)),[()=>k(s())],U),xt("click",i,Jt(M)),xt("click",r,Jt(x)),$t(e,t)};Tt($,(e=>{"edit"===v()&&e(E)}));var C=se($,2),L=re(C),T=e=>{var t=wn(),n=se(re(t),2),l=re(n),i=se(n,2),r=re(i),a=se(i,2),u=re(a),c=se(a,2),d=e=>{var t=yn(),n=se(re(t),2),o=re(n);he((e=>Et(o,e)),[()=>JSON.stringify(s().config,null,2)],U),$t(e,t)};Tt(c,(e=>{s().config&&e(d)})),he((e=>{Et(l,e),Et(r,`Tipo: ${s().type??""}`),Et(u,`Dimensioni: ${ct(o).w??""}×${ct(o).h??""}`)}),[()=>k(s())],U),$t(e,t)},R=e=>{$t(e,bn())};Tt(L,(e=>{s()?e(T):e(R,!1)}));var q=se(C,2),j=e=>{$t(e,zn())};Tt(q,(e=>{"edit"===v()&&c()&&e(j)}));var A=se(q,2),P=e=>{$t(e,Sn())};Tt(A,(e=>{c()&&"edit"===v()&&e(P)})),Ht(D,(e=>Y(g,e)),(()=>ct(g))),he((e=>{_=It(D,0,"module-container svelte-1ki5div",0,_,e),Wt(D,`\n        left: ${ct(n).x/ct(l)*100}%; \n        top: ${ct(n).y*ct(i)}px;\n        width: ${ct(r)??""}%;\n        height: ${ct(a)??""}px;\n    `)}),[()=>({selected:c(),dragging:d(),resizing:f(),"edit-mode":"edit"===v()})],U),xt("mousedown",D,(function(e){"edit"===v()&&(e.preventDefault(),e.stopPropagation(),an.selectModule(s().id),e.target.classList.contains("resize-handle")?(ct(o),an.setResizing(!0,s().id),document.addEventListener("mousemove",z),document.addEventListener("mouseup",S)):ct(h)&&ct(h).contains(e.target)&&function(e){const t=ct(g).getBoundingClientRect();y={x:e.clientX-t.left,y:e.clientY-t.top},an.setDragging(!0,s().id),document.addEventListener("mousemove",w),document.addEventListener("mouseup",b)}(e))})),xt("drop",D,(function(e){e.preventDefault(),e.dataTransfer.getData("text/plain")})),xt("dragover",D,(function(e){e.preventDefault()})),$t(e,D),N()}var kn=Dt('<div class="drop-zone-hint svelte-18jz91f"><p class="svelte-18jz91f">📦 Trascina moduli dalla palette o clicca per aggiungere</p></div>'),Dn=Dt('<div class="grid-info svelte-18jz91f"><div class="grid-stats svelte-18jz91f"><h3 class="svelte-18jz91f">🏗️ Workspace Grid</h3> <p class="svelte-18jz91f"><strong class="svelte-18jz91f">Colonne:</strong> </p> <p class="svelte-18jz91f"><strong class="svelte-18jz91f">Altezza cella:</strong> </p> <p class="svelte-18jz91f"><strong class="svelte-18jz91f">Zoom:</strong> </p> <p class="svelte-18jz91f"><strong class="svelte-18jz91f">Modalità:</strong> </p></div> <div class="quick-actions svelte-18jz91f"><h4 class="svelte-18jz91f">🚀 Azioni Rapide</h4> <ul class="svelte-18jz91f"><li class="svelte-18jz91f">Trascina moduli dalla palette a sinistra</li> <li class="svelte-18jz91f">Clicca su un modulo per selezionarlo</li> <li class="svelte-18jz91f">Usa i controlli nell\'header per salvare</li> <li class="svelte-18jz91f">Cambia modalità visualizzazione dall\'header</li></ul></div></div>'),_n=Dt('<div class="module-count-badge svelte-18jz91f"> </div>'),$n=Dt("<div><!> <!> <!> <!></div>");function En(e,t){O(t,!1);const n=X(),o=X(),l=X(),i=X(),r=X();let a=Qt(t,"modules",24,(()=>[])),s=Qt(t,"layout",24,(()=>({}))),u=Qt(t,"documentContext",24,(()=>({})));const c=nn();let d=X(),f={},v=null,p=X("edit"),m=X(1);const g=an.subscribe((e=>{f=e,v=e.selection,Y(p,e.viewMode),Y(m,e.zoom)}));function h(e){e.target.closest(".module-container")||an.clearSelection()}function y(e){e.preventDefault();const t=e.dataTransfer.getData("text/plain");if(t)try{const l=JSON.parse(t),r=ct(d).getBoundingClientRect(),a=Math.floor((e.clientX-r.left-ct(i)[0])/(r.width/ct(n))),s=Math.floor((e.clientY-r.top-ct(i)[1])/ct(o)),u={x:Math.max(0,Math.min(a,ct(n)-l.defaultSize.w)),y:Math.max(0,s)};c("module-add",{moduleType:l.id,position:u,defaultSize:l.defaultSize})}catch(e){console.error("Errore parsing module data:",e)}}function w(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"}function b(e){const{moduleId:t,layoutConfig:n}=e.detail;c("module-update",{moduleId:t,layoutConfig:n})}function z(e){const{moduleId:t}=e.detail;c("module-remove",{moduleId:t})}function S(e){return f.modules.get(e.id)||e.layoutConfig||{}}en((()=>{ct(d)&&(ct(d).addEventListener("drop",y),ct(d).addEventListener("dragover",w)),document.addEventListener("click",h)})),tn((()=>{g(),ct(d)&&(ct(d).removeEventListener("drop",y),ct(d).removeEventListener("dragover",w)),document.removeEventListener("click",h)})),pe((()=>pt(s())),(()=>{Y(n,s().gridSize||12)})),pe((()=>pt(s())),(()=>{Y(o,s().cellHeight||60)})),pe((()=>pt(s())),(()=>{Y(l,s().margin||[10,10])})),pe((()=>pt(s())),(()=>{Y(i,s().containerPadding||[20,20])})),pe((()=>{}),(()=>{Y(r,function(){if("edit"!==ct(p))return"";const e=100/ct(n),t=[],l=[];for(let t=1;t<ct(n);t++){const n=t*e;l.push(`${n}% 0, ${n}% 100%`)}for(let e=1;e<=20;e++){const n=e*ct(o);t.push(`0 ${n}px, 100% ${n}px`)}return[...l.map((e=>`linear-gradient(90deg, transparent ${e.split(",")[0]}, #e9ecef ${e.split(",")[0]}, #e9ecef calc(${e.split(",")[0]} + 1px), transparent calc(${e.split(",")[0]} + 1px))`)),...t.map((e=>`linear-gradient(0deg, transparent ${e.split(" ")[1].split(",")[0]}, #e9ecef ${e.split(" ")[1].split(",")[0]}, #e9ecef calc(${e.split(" ")[1].split(",")[0]} + 1px), transparent calc(${e.split(" ")[1].split(",")[0]} + 1px))`))].join(", ")}())})),me(),Vt();var x=$n();let M;var k=re(x),D=e=>{$t(e,kn())};Tt(k,(e=>{"edit"===ct(p)&&e(D)}));var _=se(k,2);qt(_,1,a,(e=>e.id),((e,t)=>{const n=U((()=>S(ct(t)))),o=U((()=>{return e=ct(t).id,v===e;var e})),l=U((()=>{return e=ct(t).id,f.isDragging&&v===e;var e})),i=U((()=>{return e=ct(t).id,f.isResizing&&v===e;var e}));Mn(e,{get module(){return ct(t)},get layoutConfig(){return ct(n)},get isSelected(){return ct(o)},get isDragging(){return ct(l)},get isResizing(){return ct(i)},get viewMode(){return ct(p)},get documentContext(){return u()},$$events:{update:b,remove:z}})}));var $=se(_,2),E=e=>{var t=Dn(),l=re(t),i=se(re(l),2),r=se(re(i)),a=se(i,2),s=se(re(a)),u=se(a,2),c=se(re(u)),d=se(u,2),f=se(re(d));he((e=>{Et(r,` ${ct(n)??""}`),Et(s,` ${ct(o)??""}px`),Et(c,` ${e??""}%`),Et(f,` ${ct(p)??""}`)}),[()=>Math.round(100*ct(m))],U),$t(e,t)};Tt($,(e=>{"edit"===ct(p)&&0===a().length&&e(E)}));var C=se($,2),L=e=>{var t=_n(),n=re(t);he((()=>Et(n,`🧩 ${a().length??""} modulo${1!==a().length?"i":""}`))),$t(e,t)};Tt(C,(e=>{a().length>0&&e(L)})),Ht(x,(e=>Y(d,e)),(()=>ct(d))),he(((e,t)=>{M=It(x,0,"grid-layout svelte-18jz91f",0,M,e),Wt(x,`\n        padding: ${ct(i)[1]??""}px ${ct(i)[0]??""}px;\n        transform: scale(${ct(m)??""});\n        transform-origin: top left;\n        background-image: ${ct(r)??""};\n        min-height: ${t??""}px;\n    `)}),[()=>({"edit-mode":"edit"===ct(p),"preview-mode":"preview"===ct(p),"present-mode":"present"===ct(p)}),()=>Math.max(600,(Math.max(...a().map((e=>{const t=S(e),n=t.position||{y:0},l=t.size||{h:3};return(n.y+l.h)*ct(o)})))||10)+2*ct(i)[1])],U),$t(e,x),N()}var Cn=Dt('<button class="clear-search svelte-f8ygh8">✕</button>'),Ln=Dt("<button> </button>"),Tn=Dt('<button class="reset-search svelte-f8ygh8">Cancella ricerca</button>'),Rn=Dt('<div class="no-modules svelte-f8ygh8"><p class="svelte-f8ygh8">🔍 Nessun modulo trovato</p> <!></div>'),qn=Dt('<div class="module-item svelte-f8ygh8" draggable="true" title="Clicca per aggiungere al centro o trascina nella posizione desiderata"><div class="module-icon svelte-f8ygh8"> </div> <div class="module-info svelte-f8ygh8"><h4 class="module-name svelte-f8ygh8"> </h4> <p class="module-description svelte-f8ygh8"> </p> <div class="module-meta svelte-f8ygh8"><span class="module-size svelte-f8ygh8"> </span> <span class="module-category svelte-f8ygh8"> </span></div></div></div>'),jn=Dt('<aside class="module-palette svelte-f8ygh8"><div class="palette-header svelte-f8ygh8"><h3 class="svelte-f8ygh8">🧩 Moduli</h3> <p class="palette-subtitle svelte-f8ygh8">Trascina o clicca per aggiungere</p></div> <div class="search-section svelte-f8ygh8"><div class="search-input-wrapper svelte-f8ygh8"><input type="text" placeholder="Cerca moduli..." class="search-input svelte-f8ygh8"/> <!></div></div> <div class="category-filter svelte-f8ygh8"><button>🌟 Tutti</button> <!></div> <div class="module-list svelte-f8ygh8"><!></div> <div class="palette-footer svelte-f8ygh8"><div class="usage-hint svelte-f8ygh8"><h4 class="svelte-f8ygh8">💡 Come utilizzare:</h4> <ul class="svelte-f8ygh8"><li class="svelte-f8ygh8"><strong>Clicca</strong> per aggiungere al centro</li> <li class="svelte-f8ygh8"><strong>Trascina</strong> per posizionare</li> <li class="svelte-f8ygh8"><strong>Cerca</strong> per trovare rapidamente</li></ul></div></div></aside>');function On(e,t){O(t,!1);const n=X(),o=nn(),l=[{id:"contact-card",name:"Contact Card",description:"Scheda contatto con informazioni base",icon:"👤",category:"basic",defaultSize:{w:4,h:3}},{id:"data-table",name:"Data Table",description:"Tabella dati con ordinamento e filtri",icon:"📊",category:"data",defaultSize:{w:8,h:4}},{id:"crew-list",name:"Crew List",description:"Lista membri crew con ruoli",icon:"🎬",category:"specialized",defaultSize:{w:6,h:5}},{id:"project-timeline",name:"Timeline",description:"Timeline progetto con milestone",icon:"📅",category:"project",defaultSize:{w:10,h:3}},{id:"budget-tracker",name:"Budget Tracker",description:"Tracker budget e spese",icon:"💰",category:"finance",defaultSize:{w:6,h:4}},{id:"notes-board",name:"Notes Board",description:"Board per note e appunti",icon:"📝",category:"basic",defaultSize:{w:4,h:4}},{id:"file-manager",name:"File Manager",description:"Gestore file e documenti",icon:"📁",category:"utility",defaultSize:{w:5,h:4}},{id:"smart-form",name:"Smart Form",description:"Form dinamico con validazione",icon:"📋",category:"basic",defaultSize:{w:4,h:5}}],i={basic:{name:"Base",icon:"🔧"},data:{name:"Dati",icon:"📊"},specialized:{name:"Specializzati",icon:"🎯"},project:{name:"Progetto",icon:"📋"},finance:{name:"Finanza",icon:"💰"},utility:{name:"Utilità",icon:"⚙️"}};let r=X("all"),a=X("");function s(e){e.target.classList.remove("dragging")}function u(){Y(a,"")}pe((()=>(ct(r),ct(a))),(()=>{Y(n,l.filter((e=>{const t="all"===ct(r)||e.category===ct(r),n=""===ct(a)||e.name.toLowerCase().includes(ct(a).toLowerCase())||e.description.toLowerCase().includes(ct(a).toLowerCase());return t&&n})))})),me(),Vt();var c=jn(),d=se(re(c),2),f=re(d),v=re(f),p=se(v,2),m=e=>{var t=Cn();xt("click",t,u),$t(e,t)};Tt(p,(e=>{ct(a)&&e(m)}));var g=se(d,2),h=re(g);let y;qt(se(h,2),1,(()=>Object.entries(i)),Rt,((e,t)=>{var n=function(e){const t=W(e);return He(t),t}((()=>function(e,t){if(Array.isArray(e))return e;if(!(Symbol.iterator in e))return Array.from(e);const n=[];for(const o of e)if(n.push(o),n.length===t)break;return n}(ct(t),2)));let o=()=>ct(n)[0],l=()=>ct(n)[1];var i=Ln();let a;var s=re(i);he((e=>{a=It(i,0,"category-btn svelte-f8ygh8",0,a,e),Et(s,`${l().icon??""} ${l().name??""}`)}),[()=>({active:ct(r)===o()})],U),xt("click",i,(()=>Y(r,o()))),$t(e,i)}));var w=re(se(g,2)),b=e=>{var t=Rn(),n=se(re(t),2),o=e=>{var t=Tn();xt("click",t,u),$t(e,t)};Tt(n,(e=>{ct(a)&&e(o)})),$t(e,t)},z=e=>{var t,l,r,a=(t=document.createDocumentFragment(),l=document.createComment(""),r=oe(),t.append(l,r),kt(l,r),t);qt(ae(a),1,(()=>ct(n)),Rt,((e,t)=>{var n=qn(),l=re(n),r=re(l),a=re(se(l,2)),u=re(a),c=se(a,2),d=re(c),f=re(se(c,2)),v=re(f),p=re(se(f,2));he((()=>{Et(r,ct(t).icon),Et(u,ct(t).name),Et(d,ct(t).description),Et(v,`${ct(t).defaultSize.w??""}×${ct(t).defaultSize.h??""}`),Et(p,i[ct(t).category]?.name||ct(t).category)})),xt("dragstart",n,(e=>function(e,t){e.dataTransfer.setData("text/plain",JSON.stringify(t)),e.dataTransfer.effectAllowed="copy",e.target.classList.add("dragging")}(e,ct(t)))),xt("dragend",n,s),xt("click",n,(e=>function(e,t){const n=document.querySelector(".grid-container");if(!n)return;const l=n.getBoundingClientRect(),i={x:Math.floor((t.clientX-l.left)/100),y:Math.floor((t.clientY-l.top)/60)};o("add-module",{moduleType:e.id,position:i,defaultSize:e.defaultSize})}(ct(t),e))),$t(e,n)})),$t(e,a)};Tt(w,(e=>{0===ct(n).length?e(b):e(z,!1)})),he((e=>y=It(h,0,"category-btn svelte-f8ygh8",0,y,e)),[()=>({active:"all"===ct(r)})],U),function(e,t,n=t){var o=A();bt(e,"input",(l=>{var i=l?e.defaultValue:e.value;if(i=Ut(e)?Bt(i):i,n(i),o&&i!==(i=t())){var r=e.selectionStart,a=e.selectionEnd;e.value=i??"",null!==a&&(e.selectionStart=r,e.selectionEnd=Math.min(a,e.value.length))}})),null==dt(t)&&e.value&&n(Ut(e)?Bt(e.value):e.value),ge((()=>{var n=t();Ut(e)&&n===Bt(e.value)||("date"!==e.type||n||e.value)&&n!==e.value&&(e.value=n??"")}))}(v,(()=>ct(a)),(e=>Y(a,e))),xt("click",h,(()=>Y(r,"all"))),$t(e,c),N()}var Nn=Dt('<div class="loading-state svelte-q9zwt2"><div class="spinner svelte-q9zwt2"></div> <p class="svelte-q9zwt2">Caricamento workspace...</p></div>'),An=Dt('<div class="error-state svelte-q9zwt2"><h2 class="svelte-q9zwt2">❌ Errore</h2> <p class="svelte-q9zwt2"> </p> <button class="svelte-q9zwt2">Ricarica</button></div>'),Pn=Dt('<!> <div class="workspace-container svelte-q9zwt2"><aside class="module-palette-sidebar svelte-q9zwt2"><!></aside> <section class="grid-container svelte-q9zwt2"><!></section></div>',1),In=Dt('<div class="welcome-screen svelte-q9zwt2"><h1 class="svelte-q9zwt2">🎯 SSOT-4000 Workspace</h1> <p class="svelte-q9zwt2">Sistema di orchestrazione documenti con moduli dinamici</p> <div class="welcome-actions svelte-q9zwt2"><button class="primary-btn svelte-q9zwt2">📄 Crea Nuovo Documento</button> <button class="secondary-btn svelte-q9zwt2">📂 Apri Documento Esistente</button></div> <div class="architecture-overview svelte-q9zwt2"><h3 class="svelte-q9zwt2">🏗️ Architettura SSOT-4000</h3> <ul class="svelte-q9zwt2"><li class="svelte-q9zwt2">✅ <strong class="svelte-q9zwt2">CompositeDocument</strong> - Meta-meta-entità orchestratore</li> <li class="svelte-q9zwt2">✅ <strong class="svelte-q9zwt2">Workspace Dinamico</strong> - Grid-based UI con Svelte</li> <li class="svelte-q9zwt2">🚧 <strong class="svelte-q9zwt2">Context Inheritance</strong> - Propagazione automatica contesto</li> <li class="svelte-q9zwt2">🚧 <strong class="svelte-q9zwt2">Real-time Sync</strong> - WebSocket multi-client</li></ul></div></div>'),Wn=Dt('<main class="document-workspace svelte-q9zwt2"><!></main>');function Un(e,t){O(t,!1);let n,o,l=Qt(t,"documentId",8,null),i=X(null),r=X(null),a=X([]),s=X(!0),u=X(null);function c(){console.log("🆕 Crea nuovo documento")}function d(){ct(i)&&an.saveLayout(ct(i).id)}function f(e){const{moduleType:t,position:n}=e.detail;ct(i)&&ln.addModule(ct(i).id,t,n)}function v(e){const{moduleId:t}=e.detail;ct(i)&&ln.removeModule(ct(i).id,t)}function p(e){const{moduleId:t,layoutConfig:n}=e.detail;ct(i)&&ln.updateModuleLayout(ct(i).id,t,n)}en((async()=>{console.log("🏗️ DocumentWorkspace inizializzato per documento:",l()),n=ln.subscribe((e=>{Y(i,e.document),Y(a,e.modules||[]),Y(s,e.loading),Y(u,e.error)})),o=an.subscribe((e=>{Y(r,e)})),l()?await async function(e){try{await ln.loadDocument(e),an.initializeForDocument(e)}catch(e){console.error("Errore caricamento documento:",e)}}(l()):Y(s,!1)})),tn((()=>{n&&n(),o&&o()})),Vt();var m=Wn(),g=re(m),h=e=>{$t(e,Nn())},y=(e,t)=>{var n=e=>{var t=An(),n=se(re(t),2),o=re(n),l=se(n,2);he((()=>Et(o,ct(u)))),xt("click",l,(()=>location.reload())),$t(e,t)},o=(e,t)=>{var n=e=>{var t=Pn(),n=ae(t);gn(n,{get document(){return ct(i)},$$events:{save:d,create:c}});var o=re(se(n,2));On(re(o),{$$events:{"add-module":f}});var l=re(se(o,2));const s=U((()=>ct(r)?.layout||{}));En(l,{get modules(){return ct(a)},get layout(){return ct(s)},$$events:{"module-update":p,"module-remove":v}}),$t(e,t)},o=e=>{var t=In(),n=se(re(t),4),o=re(n),l=se(o,2);xt("click",o,c),xt("click",l,(()=>{})),$t(e,t)};Tt(e,(e=>{ct(i)?e(n):e(o,!1)}),t)};Tt(e,(e=>{ct(u)?e(n):e(o,!1)}),t)};Tt(g,(e=>{ct(s)?e(h):e(y,!1)})),$t(e,m),N()}const Bn=(Fn=function(e,t){O(t,!1);let n=X(null);en((()=>{console.log("🎯 SSOT-4000 Svelte Workspace inizializzato");const e=new URLSearchParams(window.location.search).get("documentId");e?(Y(n,e),console.log("📄 Caricamento documento da URL:",ct(n))):console.log("🏠 Modalità home - nessun documento specificato")})),Vt(),Un(e,{get documentId(){return ct(n)}}),N()},Hn={target:document.body},function(e,{target:t,anchor:n,props:l={},events:r,context:a,intro:s=!0}){!function(){if(void 0===Q){Q=window,ee=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;te=i(t,"firstChild").get,ne=i(t,"nextSibling").get,c(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),c(n)&&(n.__t=void 0)}}();var u=new Set,d=e=>{for(var n=0;n<e.length;n++){var o=e[n];if(!u.has(o)){u.add(o);var l=ht(o);t.addEventListener(o,Mt,{passive:l});var i=Ct.get(o);void 0===i?(document.addEventListener(o,Mt,{passive:l}),Ct.set(o,1)):Ct.set(o,i+1)}}};d(o(zt)),St.add(d);var f=void 0,v=function(e){const t=ce(m,e,!0);return(e={})=>new Promise((n=>{e.outro?Me(t,(()=>{Se(t),n(void 0)})):(Se(t),n(void 0))}))}((()=>{var o=n??t.appendChild(oe());return we((()=>{a&&(O({}),q.c=a),r&&(l.$$events=r),f=e(o,l)||{},a&&N()})),()=>{for(var e of u){t.removeEventListener(e,Mt);var l=Ct.get(e);0===--l?(document.removeEventListener(e,Mt),Ct.delete(e)):Ct.set(e,l)}St.delete(d),o!==n&&o.parentNode?.removeChild(o)}}));return Lt.set(f,v),f}(Fn,Hn));var Fn,Hn;return Bn}();
//# sourceMappingURL=bundle.js.map
